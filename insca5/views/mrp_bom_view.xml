<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <record id="mrp_bom_form_maincer" model="ir.ui.view">
            <field name="name">mrp.bom.form.maincer</field>
            <field name="model">mrp.bom</field>
            <field name="priority">18</field>
            <field name="inherit_id" ref="mrp.mrp_bom_form_view"/>
            <field name="arch" type="xml">
                <xpath expr="//sheet[1]" position="before">
                    <header>
                       <field name="state" widget="statusbar" statusbar_visible="ot,almacen,compras,montaje,completado"
                              options="{'clickable': '1'}"/>
                    </header>
                </xpath>

                <xpath expr="//field[@name='code']" position="replace">
                    <field name="code" string="R.20"/>
                </xpath>

                <field name="bom_line_ids" position="replace">
                    <field name="bom_line_ids" widget="one2many_search"
                           context="{'default_parent_product_tmpl_id': product_tmpl_id, 'default_product_id': False, 'default_company_id': company_id, 'default_bom_id': id}">
                        <tree string="Components" limit="9999" editable="bottom"
                              options='{"bg_color": "#58d68d: recibido != False"}'>
                            <field name="company_id" invisible="1"
                                   options='{"bg_color": "#58d68d: recibido != False"}'/>
                            <field name="sequence" widget="handle"
                                   options='{"bg_color": "#58d68d: recibido != False"}'/>
                            <field name="n_pedido_compras" optional="show"
                                   options='{"bg_color": "#58d68d: recibido != False"}'/>
                            <field name="entregado" optional="show" widget="boolean_toggle"
                                   options='{"bg_color": "#58d68d: recibido != False"}'/>
                            <field name="recibido" optional="show" widget="boolean_toggle"
                                   options='{"bg_color": "#58d68d: recibido != False"}'/>
                            <field name="recibido_por" optional="show"
                                   options='{"bg_color": "#58d68d: recibido != False"}'/>
                            <field name="product_qty" options='{"bg_color": "#58d68d: recibido != False"}'/>
                            <field name="product_id" context="{'default_detailed_type': 'product'}"
                                   options='{"bg_color": "#58d68d: recibido != False"}'/>
                            <field name="product_name" optional="show"
                                   options='{"bg_color": "#58d68d: recibido != False"}'/>
                            <field name="material" optional="show"
                                   options='{"bg_color": "#58d68d: recibido != False"}'/>
                            <field name="acabado" optional="show" options='{"bg_color": "#58d68d: recibido != False"}'/>
                            <field name="subconjunto" optional="show"
                                   options='{"bg_color": "#58d68d: recibido != False"}'/>
                            <field name="seccion" optional="show" options='{"bg_color": "#58d68d: recibido != False"}'/>
                            <field name="product_tmpl_id" invisible="1"
                                   options='{"bg_color": "#58d68d: recibido != False"}'/>
                            <!--<button name="action_see_attachments" type="object" icon="fa-files-o"
                                    aria-label="Product Attachments" title="Product Attachments"
                                    class="float-right oe_read_only"/>-->

                            <field name="attachments_count" class="text-left oe_read_only" string=" " invisible="1"
                                   options='{"bg_color": "#58d68d: recibido != False"}'/>
                            <field name="product_uom_category_id" invisible="1"
                                   options='{"bg_color": "#58d68d: recibido != False"}'/>
                            <field name="parent_product_tmpl_id" invisible="1"
                                   options='{"bg_color": "#58d68d: recibido != False"}'/>
                            <field name="product_uom_id"
                                   options="{'no_open':True,'no_create':True,'bg_color': '#58d68d: recibido != False'}"
                                   groups="uom.group_uom"/>
                            <field name="possible_bom_product_template_attribute_value_ids" invisible="1"
                                   options='{"bg_color": "#58d68d: recibido != False"}'/>
                            <field name="bom_product_template_attribute_value_ids" optional="hide"
                                   widget="many2many_tags"
                                   options="{'no_create': True,'bg_color': '#58d68d: recibido != False'}"
                                   attrs="{'column_invisible': [('parent.product_id', '!=', False)]}"
                                   groups="product.group_product_variant"/>
                            <field name="allowed_operation_ids" invisible="1"
                                   options='{"bg_color": "#58d68d: recibido != False"}'/>
                            <field name="operation_id" groups="mrp.group_mrp_routings" optional="hidden"
                                   attrs="{'column_invisible': [('parent.type','not in', ('normal', 'phantom'))]}"
                                   options="{'no_quick_create':True,'no_create_edit':True,'bg_color': '#58d68d: recibido != False'}"/>
                        </tree>
                    </field>
                </field>
                <field name="bom_line_ids" position="after">
                    <label for="observaciones" string="Observaciones"/>
                    <field name="observaciones"/>
                </field>
                <xpath expr="//group[1]" position="after">
                    <group>
                        <group>
                            <label for="cliente" string="Cliente"/>
                            <div>
                                <li class="list-inline-item">
                                    <field name="cliente"/>
                                </li>
                                -
                                <li class="list-inline-item">
                                    <field name="cliente_ref"/>
                                </li>
                            </div>

                            <field name="trabajo"/>
                            <field name="codigo_plano"/>
                            <field name="n_cee"/>
                        </group>
                        <group>
                            <label for="emitido" string="Emitido por"/>
                            <div>
                                <li style="width:34mm" class="list-inline-item">
                                    <field name="emitido"/>
                                </li>
                                <li style="width:34mm" class="list-inline-item">
                                    <field name="fecha_solicitud"/>
                                </li>
                            </div>

                            <label for="preparado" string="Preparado por"/>
                            <div>
                                <li style="width:34mm" class="list-inline-item">
                                    <field name="preparado"/>
                                </li>
                                <li style="width:34mm" class="list-inline-item">
                                    <field name="fecha_recepcion"/>
                                </li>
                            </div>

                            <label for="recogido" string="Recogido por"/>
                            <div>
                                <li style="width:34mm" class="list-inline-item">
                                    <field name="recogido"/>
                                </li>
                                <li style="width:34mm" class="list-inline-item">
                                    <field name="fecha_recogido"/>
                                </li>
                            </div>

                            <field name="fecha_entrega_cliente"/>
                            <field name="seccion"/>
                        </group>
                    </group>
                    <!--<group>
                        <field name="secciones" widget="many2many_tags"/>
                    </group>-->
                </xpath>
            </field>
        </record>

        <record id="mrp_bom_tree_view_maincer" model="ir.ui.view">
            <field name="name">mrp.bom.tree.view.maincer</field>
            <field name="model">mrp.bom</field>
            <field name="inherit_id" ref="mrp.mrp_bom_tree_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='product_tmpl_id']" position="attributes">
                    <attribute name="invisible">True</attribute>
                </xpath>
                <xpath expr="//field[@name='type']" position="attributes">
                    <attribute name="invisible">True</attribute>
                </xpath>
                <xpath expr="//field[@name='product_tmpl_id']" position="after">
                    <field name="trabajo"/>
                    <field name="cliente"/>
                </xpath>
                <xpath expr="//field[@name='product_tmpl_id']" position="before">
                    <field name="product_default_code"/>
                    <field name="n_cee" optional="show"/>
                    <field name="product_name"/>
                </xpath>
                <xpath expr="//field[@name='code']" position="after">
                    <field name="state" optional="show"/>
                    <field name="total_lineas" optional="show"/>
                    <field name="total_lineas_recibido" optional="show"/>
                </xpath>
                <xpath expr="//field[@name='code']" position="replace">
                    <field name="code" string="R.20"/>
                </xpath>
            </field>
        </record>

        <record id="mrp_bom_select_maincer" model="ir.ui.view">
            <field name="name">mrp.bom.select.maincer</field>
            <field name="model">mrp.bom</field>
            <field name="priority">18</field>
            <field name="inherit_id" ref="mrp.view_mrp_bom_filter"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='product_tmpl_id']" position="before">
                    <field name="n_cee"/>
                </xpath>
            </field>
        </record>

        <record id="mrp_bom_smart_button" model="ir.ui.view">
            <field name="name">mrp.view.buttons</field>
            <field name="model">mrp.bom</field>
            <field name="inherit_id" ref="mrp.mrp_bom_form_view" />
            <field name="arch" type="xml">
                <div name="button_box" position="inside">
                    <button class="oe_stat_button" type="object" name="get_bom_lines" icon="fa-list">
                        <field string="Líneas" name="line_count" widget="statinfo"/>
                    </button>
                </div>
            </field>
        </record>

    </data>
</odoo>